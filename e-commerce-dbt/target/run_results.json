{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.2", "generated_at": "2025-03-24T14:37:19.117544Z", "invocation_id": "86976827-09fe-4089-8880-1987d31a56a2", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-24T14:37:08.618642Z", "completed_at": "2025-03-24T14:37:08.682975Z"}, {"name": "execute", "started_at": "2025-03-24T14:37:08.686511Z", "completed_at": "2025-03-24T14:37:12.928129Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 4.317437648773193, "adapter_response": {"_message": "CREATE TABLE (32.9k rows, 3.3 MiB processed)", "code": "CREATE TABLE", "rows_affected": 32949, "bytes_processed": 3501976, "bytes_billed": 20971520, "location": "US", "project_id": "dsai-g3-m2-project", "job_id": "89b7cd02-9dc8-4f53-8621-2341c8c339ce", "slot_ms": 10284}, "message": "CREATE TABLE (32.9k rows, 3.3 MiB processed)", "failures": null, "unique_id": "model.ec_sales.dim_products", "compiled": true, "compiled_code": "\n\nWITH product_details AS (\n    SELECT\n        product_id,\n        product_category_name,\n        product_name_lenght AS product_name_length,\n        product_description_lenght AS product_description_length,\n        product_photos_qty,\n        product_weight_g,\n        product_length_cm,\n        product_height_cm,\n        product_width_cm,\n        (product_length_cm * product_height_cm * product_width_cm) AS product_volume_cm3,\n    FROM `dsai-g3-m2-project`.`gcs_ingestion`.`olist_products_dataset`\n),\n\ncategory_name_translation AS (\n    SELECT\n        string_field_0 AS product_category_name_pt,\n        string_field_1 AS product_category_name_en\n    FROM `dsai-g3-m2-project`.`gcs_ingestion`.`product_category_name_translation`\n)\n\nSELECT \n    p.product_id,\n    COALESCE(cnt.product_category_name_en, 'others') AS product_category_name,\n    COALESCE(p.product_name_length, 0) AS product_name_length,\n    COALESCE(p.product_description_length, 0) AS product_description_length,\n    COALESCE(p.product_photos_qty, 0) AS product_photos_qty,\n    p.product_weight_g,\n    p.product_length_cm,\n    p.product_height_cm,\n    p.product_width_cm,\n    p.product_volume_cm3,\nFROM product_details p LEFT JOIN category_name_translation cnt\nON p.product_category_name = cnt.product_category_name_pt\nWHERE p.product_weight_g IS NOT NULL\nAND p.product_length_cm IS NOT NULL\nAND p.product_height_cm IS NOT NULL\nAND p.product_width_cm IS NOT NULL\nAND p.product_volume_cm3 IS NOT NULL", "relation_name": "`dsai-g3-m2-project`.`brazilian_ecommerce_sales`.`dim_products`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-24T14:37:12.961300Z", "completed_at": "2025-03-24T14:37:13.012848Z"}, {"name": "execute", "started_at": "2025-03-24T14:37:13.016710Z", "completed_at": "2025-03-24T14:37:19.000873Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 6.048865079879761, "adapter_response": {"_message": "CREATE TABLE (98.7k rows, 15.1 MiB processed)", "code": "CREATE TABLE", "rows_affected": 98666, "bytes_processed": 15849557, "bytes_billed": 20971520, "location": "US", "project_id": "dsai-g3-m2-project", "job_id": "47fa89e7-d72c-4e05-b036-9d5bebf0bb3d", "slot_ms": 33214}, "message": "CREATE TABLE (98.7k rows, 15.1 MiB processed)", "failures": null, "unique_id": "model.ec_sales.fact_orders", "compiled": true, "compiled_code": "/*\n    Welcome to your first dbt model!\n    Did you know that you can also configure models directly within SQL files?\n    This will override configurations stated in dbt_project.yml\n\n    Try changing \"table\" to \"view\" below\n*/\n\n\n\n\nwith order_details as (\n    select\n        o.order_id,\n        o.customer_id,\n        o.order_status,\n        o.order_purchase_timestamp,\n        o.order_delivered_customer_date,\n        o.order_estimated_delivery_date\n    from `dsai-g3-m2-project`.`gcs_ingestion`.`olist_orders_dataset` as o\n),\n\n--# ARRAY_AGG(product_id) AS product_ids or GROUP_CONCAT(product_id) AS product_ids to add product and seller info\norder_items_agg as (\n    select\n        oi.order_id,\n        count(*) as num_items,\n        sum(oi.price) as total_order_revenue,\n        sum(oi.freight_value) as total_freight_cost,\n        avg(oi.price) as avg_item_price\n    from `dsai-g3-m2-project`.`gcs_ingestion`.`olist_order_items_dataset` as oi\n    group by oi.order_id\n)\n\nselect\n    od.order_id,\n    od.customer_id,\n    od.order_status,\n    od.order_purchase_timestamp,\n    od.order_delivered_customer_date,\n    od.order_estimated_delivery_date,\n    oia.num_items,\n    oia.total_order_revenue,\n    oia.total_freight_cost,\n    oia.avg_item_price,\n    -- Calculate delivery performance: total time from purchase to customer delivery\n    case \n        when od.order_delivered_customer_date is not null then \n            timestamp_diff(od.order_delivered_customer_date, od.order_purchase_timestamp, minute)\n        else null\n    end as delivery_time_minutes\nfrom order_details od join order_items_agg oia\n    on od.order_id = oia.order_id", "relation_name": "`dsai-g3-m2-project`.`brazilian_ecommerce_sales`.`fact_orders`", "batch_results": null}], "elapsed_time": 14.036724328994751, "args": {"skip_nodes_if_on_run_start_fails": false, "partial_parse": true, "static_parser": true, "favor_state": false, "strict_mode": false, "use_colors": true, "write_json": true, "version_check": true, "printer_width": 80, "log_level_file": "debug", "invocation_command": "dbt run", "indirect_selection": "eager", "introspect": true, "macro_debugging": false, "require_resource_names_without_spaces": false, "show_resource_report": false, "print": true, "state_modified_compare_more_unrendered_values": false, "which": "run", "vars": {}, "project_dir": "/mnt/c/Users/dylon/OneDrive/Desktop/NTU_SCTP_DSAI/Github/dsai-g3-m2-project/e-commerce-dbt", "send_anonymous_usage_stats": true, "cache_selected_only": false, "profiles_dir": "/mnt/c/Users/dylon/OneDrive/Desktop/NTU_SCTP_DSAI/Github/dsai-g3-m2-project/e-commerce-dbt", "log_format_file": "debug", "select": [], "require_nested_cumulative_type_params": false, "log_format": "default", "warn_error_options": {"include": [], "exclude": []}, "log_file_max_bytes": 10485760, "empty": false, "defer": false, "log_path": "/mnt/c/Users/dylon/OneDrive/Desktop/NTU_SCTP_DSAI/Github/dsai-g3-m2-project/e-commerce-dbt/logs", "require_batched_execution_for_custom_microbatch_strategy": false, "require_explicit_package_overrides_for_builtin_materializations": true, "log_level": "info", "partial_parse_file_diff": true, "source_freshness_run_project_hooks": false, "quiet": false, "exclude": [], "use_colors_file": true, "populate_cache": true, "state_modified_compare_vars": false, "require_yaml_configuration_for_mf_time_spines": false}}