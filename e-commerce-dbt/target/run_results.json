{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.2", "generated_at": "2025-03-23T06:47:09.001999Z", "invocation_id": "705f6920-76e9-4a8a-a9fc-c138c72950ef", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-23T06:47:03.216921Z", "completed_at": "2025-03-23T06:47:03.220473Z"}, {"name": "execute", "started_at": "2025-03-23T06:47:03.220624Z", "completed_at": "2025-03-23T06:47:08.934510Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 5.718353986740112, "adapter_response": {"_message": "CREATE TABLE (98.7k rows, 15.1 MiB processed)", "code": "CREATE TABLE", "rows_affected": 98666, "bytes_processed": 15849557, "bytes_billed": 20971520, "location": "US", "project_id": "dsai-module2-assignment-david", "job_id": "e25b7468-4074-4f2a-99b5-88155edca9f0", "slot_ms": 25865}, "message": "CREATE TABLE (98.7k rows, 15.1 MiB processed)", "failures": null, "unique_id": "model.ec_sales.fact_orders", "compiled": true, "compiled_code": "/*\n    Welcome to your first dbt model!\n    Did you know that you can also configure models directly within SQL files?\n    This will override configurations stated in dbt_project.yml\n\n    Try changing \"table\" to \"view\" below\n*/\n\n\n\n\nwith order_details as (\n    select\n        o.order_id,\n        o.customer_id,\n        o.order_status,\n        o.order_purchase_timestamp,\n        o.order_delivered_customer_date,\n        o.order_estimated_delivery_date\n    from `dsai-module2-assignment-david`.`sales`.`orders` as o\n),\n\n--# ARRAY_AGG(product_id) AS product_ids or GROUP_CONCAT(product_id) AS product_ids to add product and seller info\norder_items_agg as (\n    select\n        oi.order_id,\n        count(*) as num_items,\n        sum(oi.price) as total_order_revenue,\n        sum(oi.freight_value) as total_freight_cost,\n        avg(oi.price) as avg_item_price\n    from `dsai-module2-assignment-david`.`sales`.`order_items` as oi\n    group by oi.order_id\n)\n\nselect\n    od.order_id,\n    od.customer_id,\n    od.order_status,\n    od.order_purchase_timestamp,\n    od.order_delivered_customer_date,\n    od.order_estimated_delivery_date,\n    oia.num_items,\n    oia.total_order_revenue,\n    oia.total_freight_cost,\n    oia.avg_item_price,\n    -- Calculate delivery performance: total time from purchase to customer delivery\n    case \n        when od.order_delivered_customer_date is not null then \n            timestamp_diff(od.order_delivered_customer_date, od.order_purchase_timestamp, minute)\n        else null\n    end as delivery_time_minutes\nfrom order_details od join order_items_agg oia\n    on od.order_id = oia.order_id", "relation_name": "`dsai-module2-assignment-david`.`sales`.`fact_orders`", "batch_results": null}], "elapsed_time": 7.592105865478516, "args": {"quiet": false, "log_file_max_bytes": 10485760, "use_colors": true, "empty": false, "require_explicit_package_overrides_for_builtin_materializations": true, "require_batched_execution_for_custom_microbatch_strategy": false, "static_parser": true, "introspect": true, "select": [], "favor_state": false, "profiles_dir": "/Users/david/.dbt", "send_anonymous_usage_stats": true, "log_format_file": "debug", "warn_error_options": {"include": [], "exclude": []}, "partial_parse": true, "log_level": "info", "log_format": "default", "invocation_command": "dbt run", "vars": {}, "write_json": true, "state_modified_compare_more_unrendered_values": false, "indirect_selection": "eager", "require_yaml_configuration_for_mf_time_spines": false, "partial_parse_file_diff": true, "populate_cache": true, "print": true, "cache_selected_only": false, "log_level_file": "debug", "use_colors_file": true, "defer": false, "show_resource_report": false, "state_modified_compare_vars": false, "macro_debugging": false, "which": "run", "exclude": [], "require_resource_names_without_spaces": false, "project_dir": "/Users/david/Documents/Documents - David\u2019s MacBook Pro/NTU_DSAI/Materials/Module2/Project/ec_sales", "log_path": "/Users/david/Documents/Documents - David\u2019s MacBook Pro/NTU_DSAI/Materials/Module2/Project/ec_sales/logs", "skip_nodes_if_on_run_start_fails": false, "version_check": true, "require_nested_cumulative_type_params": false, "printer_width": 80, "source_freshness_run_project_hooks": false, "strict_mode": false}}